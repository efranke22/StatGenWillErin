---
title: "Multiple Hypothesis Testing"
description: "An explanation of the complexities to making statistically significant conclusions when working with genetic data."
output: 
  distill::distill_article:
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

# Learn more about creating websites with Distill at:
# https://rstudio.github.io/distill/website.html
```

## Genome Wide Association Studies

To understand the need for multiple hypothesis testing, we need to be familiar with Genome Wide Association Studies(GWAS) and the complexities to working with genetic data.

### Explanation of GWAS

If we compare any two human genomes, they are nearly identical. However, places where DNA sequences differ are known as genetic variants. Once there is a collection of variants to be studied, GWAS attempts to determine which genetic variants are associated with an illness (Type One Diabetes, Crohn's Disease) or trait of interest (height, blood pressure).

There are multiple types of genetic variants, but GWAS is focused on variants that are exchanges of one nucleotide base pair for another, otherwise known as single nucleotide polymorphisms(SNPs). Figure 1 is a visual example of a SNP.

<strong>SNPs</strong> : DNA variations that occur when a single nucleotide base pair in the genome sequence is altered (AT vs GC at a single position).

<center>
![Figure 1: SNP Example](images/geneticvariants.png){width=40%}
</center>

### Working with Genetic Data

When working with genetic data and running GWAS, the number of SNPs to be studied is commonly greater than 1,000,000. Because of this, we cannot simply fit a multiple linear regression model to predict the existence of an illness or the value of a trait of interest. As an equation, this would be equivalent to <strong>E[y | x] = Íûµ + Íûµ1x + ... + Íûµnx</strong>, where y is the trait and x is the number of minor alleles.

In this situation, our goal would be to find a line of best fit where ‚Äúbest‚Äù is described as the minimized sum of squared residuals, which requires complicated derivations. This would be quite time consuming and difficult to find the optimal Íûµ0 and Íûµ1...Íûµn considering how large the number of predictors is. Even if we used a different technique such as matrix derivation, because there are more SNPs(columns) than individuals we are studying(rows), our matrix is not invertible and thus our least squares estimator is not defined. This conclusion is proven through linear algebra.

Instead, we utilize <strong>Marginal Regression</strong>, where instead of one multiple linear model, we make "n" linear models one by one equal to the number of SNPs we are studying. As an equation, this would be equivalent to <strong>E[y | xj] = Íûµ + Íûµ1xj + ... + Íûµnxj</strong>, where y is the trait and x is the number of minor alleles at that SNP. From these marginal regressions, we receive test statistics and p-values for each SNP. Once we have a p-value for each SNP, we can begin to visualize these values and make decisions of whether or not a SNP is associated with our trait of interest. Figure 2 is an example of how we can visualize p-values, known as a Manhattan Plot. The y-axis is -log10 transformed so that smaller p-values appear as higher on the plot. For now, ignore the horizontal blue line.

<center>
![Figure 2: Manhattan Plot](images/manhatplot.png){width=90%}
</center>

## Multiple Hypothesis Testing

In order to make these decision of whether or not an association exists, we utilize hypothesis testing.

### Hypothesis Testing Review

To review, hypothesis testing is predicated on if a p-value is less than or greater than a predetermined significance threshold, commonly represented as <strong> ùõº </strong>. Furthermore, there are two hypotheses, the null hypothesis and the alternative hypothesis. If a p-value is greater than the significance threshold, we cannot reject the null hypothesis and therefore conclude the null hypothesis to be true. On the other hand, if a p-value is less than the significance threshold, we reject the null hypothesis and therefore conclude the alternative hypothesis to be true. Here is a table that recaps the decsions we can make and the consequences of those decisons

Table image

Make sure this is finished

### Hypothesis Testing in GWAS

Give context about null

But we mentioned marginal regression, so this is not just one hypothesis test, but millions. This creates an issue related to type one error, falsely rejecting the null.

Bucket Example

Image of bucket

This is further supported by this equation, proven by mathematical statistics that alpha = t1e for one test. P(at least 1 T1E) = fwer

### Determining a Threshold

we want fwer to be 0.05 not alpha, so we control with bonferroni 

imagine if .05 on manhattan plot, show image

## False Discovery Rate