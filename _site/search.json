{
  "articles": [
    {
      "path": "hapmapAnalysis.html",
      "title": "A final analysis of our HapMap data",
      "description": "How we combined our knowledge of multiple hypothesis testing and PLINK results to determine an appropriate significance threshold for our HapMap dataset\n",
      "author": [],
      "contents": "\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(janitor)\r\nlibrary(snpStats)\r\nlibrary(NatParksPalettes)\r\n\r\n\r\nRead in data from plink\r\n\r\n\r\nadjust_results <- read.table(\"plinkData/as2.assoc.adjusted\") %>%\r\n  row_to_names(row_number = 1)\r\n\r\nfam <- 'plinkData/HapMap_3_r3_1.fam'\r\nbim <- 'plinkData/HapMap_3_r3_1.bim'\r\nbed <- 'plinkData/HapMap_3_r3_1.bed'\r\n\r\nhapmap <- read.plink(bed, bim, fam)\r\n\r\n\r\nCombine snp information and p-value results\r\n\r\n\r\nadjust_with_position <- adjust_results %>%\r\n  mutate(CHR = as.integer(CHR)) %>%\r\n  left_join(hapmap$map %>%\r\n              select(snp.name, position, chromosome), by = c(\"SNP\" = \"snp.name\", \"CHR\" = \"chromosome\"))\r\n\r\n#no scientific notation\r\nadjust_with_position_no_sci <- adjust_with_position %>%\r\n  filter(!str_detect(GC, \"e-\")) %>%\r\n  mutate(GC = as.numeric(GC))\r\n\r\n#deal with scientific notation\r\nadjust_with_position_sci <- adjust_with_position %>%\r\n  filter(str_detect(GC, \"e-\")) %>%\r\n  separate(GC, into = c(\"decimal\", \"digits\"), sep = \"e-0\", remove =FALSE) %>%\r\n  mutate(decimal = as.numeric(decimal), \r\n         digits =as.numeric(digits), \r\n         GC = decimal * 10^(-digits)) %>%\r\n  select(-decimal, -digits)\r\n\r\nadjust_with_position <- bind_rows(adjust_with_position_sci, adjust_with_position_no_sci)\r\n\r\n\r\nAnalysis\r\nMost significant SNPs\r\n\r\n\r\nadjust_with_position %>%\r\n  arrange(GC) %>%\r\n  head(10)\r\n\r\n   CHR       SNP     UNADJ        GC   BONF   HOLM SIDAK_SS SIDAK_SD\r\n1    8  rs279466 5.549e-07 1.023e-06 0.7095 0.7095   0.5081   0.5081\r\n2    8  rs279460 5.549e-07 1.023e-06 0.7095 0.7095   0.5081   0.5081\r\n3    8  rs279453 5.549e-07 1.023e-06 0.7095 0.7095   0.5081   0.5081\r\n4    8 rs2623297 5.549e-07 1.023e-06 0.7095 0.7095   0.5081   0.5081\r\n5    8  rs279973 1.289e-06 2.287e-06      1      1   0.8075   0.8075\r\n6    8  rs185773 1.289e-06 2.287e-06      1      1   0.8075   0.8075\r\n7    8  rs183967 1.289e-06 2.287e-06      1      1   0.8075   0.8075\r\n8    4 rs7673394 1.325e-06 2.348e-06      1      1   0.8161   0.8161\r\n9    3 rs1097157 3.881e-06 6.552e-06      1      1    0.993    0.993\r\n10   3 rs1840290 3.881e-06 6.552e-06      1      1    0.993    0.993\r\n   FDR_BH FDR_BY  position\r\n1  0.1774      1  94153170\r\n2  0.1774      1  94155568\r\n3  0.1774      1  94157823\r\n4  0.1774      1  94158475\r\n5  0.2117      1  94132061\r\n6  0.2117      1  94132798\r\n7  0.2117      1  94133467\r\n8  0.2117      1 176437221\r\n9  0.4962      1  82780003\r\n10 0.4962      1  82785436\r\n\r\nCreate manhattan plot\r\n\r\n\r\nadjust_with_position %>%\r\n  mutate(minuslogp = -log10(GC),\r\n         CHR = as.factor(CHR)) %>%\r\n  ggplot(aes(x = CHR, y = minuslogp, group = interaction(CHR, position), color = CHR)) + \r\n  geom_point(position = position_dodge(0.8)) + \r\n  labs(x = 'chromosome', y = expression(paste('-log'[10],'(p-value)')))+\r\n  theme_classic()+\r\n  scale_color_manual(values=natparks.pals(\"DeathValley\",24))+\r\n  theme(legend.position = \"none\")\r\n\r\n\r\n\r\n\r\n\r\nhapmap$fam %>%\r\n  count(affected)\r\n\r\n  affected  n\r\n1        1 56\r\n2        2 56\r\n3       NA 53\r\n\r\nAccount for correlation\r\n\r\n\r\nchr1_200 <- hapmap$genotypes[1:165, 1:200]\r\nhapmap.ld <- ld(chr1_200, depth = 199, stats = \"R.squared\", symmetric = TRUE)\r\ncolor.pal <- natparks.pals(\"Acadia\", 10)\r\nimage(hapmap.ld, lwd = 0, cuts = 9, col.regions = color.pal, colorkey = TRUE)\r\n\r\n\r\n\r\n\r\n\r\n#get monomorphic SNPs only\r\nmaf_chr1_200 <- col.summary(chr1_200)$MAF\r\nmono <- which(maf_chr1_200 == 0)\r\n\r\n# calculate LD on polymorphic SNPs only\r\nhapmap.ld.nomono <- ld(chr1_200[,-mono], depth = 199-length(mono), stats = \"R.squared\", symmetric = TRUE)\r\n\r\n# plot \r\nimage(hapmap.ld.nomono, lwd = 0, cuts = 9, col.regions = color.pal, colorkey = TRUE)\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
      "last_modified": "2022-11-16T13:39:34-06:00"
    },
    {
      "path": "index.html",
      "title": "An Extension of Multiple Hypothesis Testing in Statistical Genetics",
      "description": "A project by Will Brazgel and Erin Franke exploring multiple hypothesis testing and using PLINK and R to efficiently execute it on genetic data\n",
      "author": [],
      "contents": "\r\nMotivation here\r\n\r\n\r\n\r\n",
      "last_modified": "2022-11-16T13:39:34-06:00"
    },
    {
      "path": "multipletesting.html",
      "title": "Multiple Hypothesis Testing",
      "description": "What it is and why it is important for when working with genetic data \n",
      "author": [],
      "contents": "\r\nExplain background of multiple testing\r\nPower of GWAS\r\n\r\n\r\n\r\n",
      "last_modified": "2022-11-16T13:42:06-06:00"
    },
    {
      "path": "plink.html",
      "title": "Understanding genetic data with PLINK",
      "description": "How we used PLINK to make analyzing genetic data more computationally efficient\n",
      "author": [],
      "contents": "\r\nExplain how we used PLINK\r\n\r\n\r\n\r\n",
      "last_modified": "2022-11-16T13:39:34-06:00"
    }
  ],
  "collections": []
}
