{
  "articles": [
    {
      "path": "hapmapAnalysis.html",
      "title": "A final analysis of our HapMap data",
      "description": "How we combined our knowledge of multiple hypothesis testing and PLINK results to determine an appropriate significance threshold for our HapMap dataset\n",
      "author": [],
      "contents": "\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(janitor)\r\nlibrary(snpStats)\r\nlibrary(NatParksPalettes)\r\n\r\n\r\nLoad hapmap data\r\nCreate a null trait and write a file to the plink data folder.\r\n\r\n\r\nfam <- 'plinkData/HapMap_3_r3_1.fam'\r\nbim <- 'plinkData/HapMap_3_r3_1.bim'\r\nbed <- 'plinkData/HapMap_3_r3_1.bed'\r\n\r\nhapmap <- read.plink(bed, bim, fam)\r\n\r\n\r\n\r\n\r\nmanhattan_data <- cbind(hapmap$fam %>% select(1:2), trait = rnorm(n = 165, mean = 0, sd = 1))\r\nwrite_delim(manhattan_data, \"plinkData/manhattandata\")\r\n\r\n\r\nUse command to run GWAS in PLINK, accounting for correlated SNPs\r\n- ./plink –bfile HapMap_3_r3_1 –assoc –adjust –pheno manhattandata –out as2\r\nRead in results from PLINK and create Manhattan plot\r\n\r\n\r\nresults <- read_table(\"plinkData/as2.qassoc.adjusted\")\r\n\r\nresults_with_position <- results %>%\r\n  mutate(CHR = as.integer(CHR)) %>%\r\n  left_join(hapmap$map %>%\r\n              select(snp.name, position, chromosome), by = c(\"SNP\" = \"snp.name\", \"CHR\" = \"chromosome\"))\r\n\r\n\r\n\r\n\r\nresults_with_position %>%\r\n  mutate(minuslogp = -log10(GC),\r\n         CHR = as.factor(CHR)) %>%\r\n  ggplot(aes(x = CHR, y = minuslogp, group = interaction(CHR, position), color = CHR)) + \r\n  geom_point(position = position_dodge(0.8)) + \r\n  labs(x = 'chromosome', y = expression(paste('-log'[10],'(p-value)')))+\r\n  theme_classic()+\r\n  scale_color_manual(values=natparks.pals(\"DeathValley\",24))+\r\n  theme(legend.position = \"none\")\r\n\r\n\r\n\r\nComplete replications\r\nSimulation based approach. Approximately 14.45 minutes to run GWAS in plink, then 3 minutes 20 seconds to load files into R.\r\n\r\n\r\ncreate_quantitative_trait <- function(i){\r\n  y <- rnorm(n = 165, mean = 0, sd = 1) \r\n}\r\n\r\ntraits <- as.data.frame(replicate(1000, create_quantitative_trait()))\r\n\r\ntraits_identified <- cbind(hapmap$fam %>%\r\n        select(1:2), traits)\r\n\r\nwrite_delim(traits_identified, \"plinkData/traits_identified\")\r\n\r\n\r\n./plink –bfile HapMap_3_r3_1 –assoc –pheno traits_identified –all-pheno –pfilter 1e-3\r\n\r\n\r\ndataFiles <- lapply(Sys.glob(\"plinkData/plink.P*.qassoc\"), read_table)\r\n\r\npvalues <- sapply(dataFiles, function(x) min(x$P, na.rm=TRUE))\r\n\r\nas.data.frame(pvalues) %>%\r\n  ggplot(aes(x=pvalues))+\r\n  geom_density(fill = \"cadetblue\")+\r\n  theme_classic()+\r\n  annotate(geom = \"text\", color = \"red\", x = 1e-05, y = 250000, label = \"0.05 quantile:\\n7.31495e-08\", family = \"mono\", cex = 3)+\r\n  geom_vline(xintercept = 7.31495e-08, color = \"red\", linetype = \"dashed\")+\r\n  labs(x=\"P-values\", y = \"Density\", title = \"Distribution of minimum p-values for 1000 replications\")+\r\n  geom_curve(aes(x = 1e-05, y = 270000, xend = 1e-06, yend = 350000), \r\n             arrow = arrow(length = unit(0.03, \"npc\")), curvature = 0.3, color = \"red\")+\r\n  theme(plot.title.position = \"plot\", \r\n        plot.title = element_text(family = \"mono\"), \r\n        axis.title = element_text(family = \"mono\"), \r\n        axis.text = element_text(family = \"mono\"))\r\n\r\n\r\nquantile(pvalues, 0.05)\r\n\r\n         5% \r\n7.31495e-08 \r\n\r\n\r\n\r\n\r\n",
      "last_modified": "2022-11-29T10:07:28-06:00"
    },
    {
      "path": "index.html",
      "title": "An Extension of Multiple Hypothesis Testing in Statistical Genetics",
      "description": "A project by Will Brazgel and Erin Franke exploring multiple hypothesis testing and using PLINK and R to efficiently execute it on genetic data\n",
      "author": [],
      "contents": "\r\nMotivation here\r\n\r\n\r\n\r\n",
      "last_modified": "2022-11-16T13:39:34-06:00"
    },
    {
      "path": "multipletesting.html",
      "title": "Multiple Hypothesis Testing",
      "description": "An explanation of the complexities to making statistically significant conclusions when working with genetic data \n",
      "author": [],
      "contents": "\r\nGenome Wide Association Studies\r\nIf we compare any two human genomes, they are nearly identical. However, places where DNA sequences differ are known as genetic variants. There are multiple types of genetic variants, but our work is primarily focused on single nucleotide variants (SNVs).\r\nSNVs : DNA variation that occurs when a single nucleotide in the genome sequence is altered (A vs G at a single position).\r\nGenetic Variant ExampleGenome Wide Association Studies can aid in the determination of which genetic variants are associated with an illness or trait of interest.\r\nIn order to make statements on whether or not a genetic variant is associated with the trait of interest, we utilize hypothesis testing.\r\nHypothesis Testing Review\r\n\r\n\r\n\r\n",
      "last_modified": "2022-11-29T10:44:01-06:00"
    },
    {
      "path": "plink.html",
      "title": "Understanding genetic data with PLINK",
      "description": "How we used PLINK to make analyzing genetic data more computationally efficient\n",
      "author": [],
      "contents": "\r\nExplain how we used PLINK\r\n\r\n\r\n\r\n",
      "last_modified": "2022-11-16T13:39:34-06:00"
    }
  ],
  "collections": []
}
