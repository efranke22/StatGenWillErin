{
  "articles": [
    {
      "path": "hapmapAnalysis.html",
      "title": "A final analysis of our HapMap data",
      "description": "How we combined our knowledge of multiple hypothesis testing and PLINK results to determine an appropriate significance threshold for our HapMap dataset\n",
      "author": [],
      "contents": "\n\n\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(snpStats)\nlibrary(NatParksPalettes)\n\n\nRead in data from plink\n\n\nadjust_results <- read.table(\"plinkData/as2.assoc.adjusted\") %>%\n  row_to_names(row_number = 1)\n\nfam <- 'plinkData/HapMap_3_r3_1.fam'\nbim <- 'plinkData/HapMap_3_r3_1.bim'\nbed <- 'plinkData/HapMap_3_r3_1.bed'\n\nhapmap <- read.plink(bed, bim, fam)\n\n\nCombine snp information and p-value results\n\n\nadjust_with_position <- adjust_results %>%\n  mutate(CHR = as.integer(CHR)) %>%\n  left_join(hapmap$map %>%\n              select(snp.name, position, chromosome), by = c(\"SNP\" = \"snp.name\", \"CHR\" = \"chromosome\"))\n\n#no scientific notation\nadjust_with_position_no_sci <- adjust_with_position %>%\n  filter(!str_detect(GC, \"e-\")) %>%\n  mutate(GC = as.numeric(GC))\n\n#deal with scientific notation\nadjust_with_position_sci <- adjust_with_position %>%\n  filter(str_detect(GC, \"e-\")) %>%\n  separate(GC, into = c(\"decimal\", \"digits\"), sep = \"e-0\", remove =FALSE) %>%\n  mutate(decimal = as.numeric(decimal), \n         digits =as.numeric(digits), \n         GC = decimal * 10^(-digits)) %>%\n  select(-decimal, -digits)\n\nadjust_with_position <- bind_rows(adjust_with_position_sci, adjust_with_position_no_sci)\n\n\nAnalysis\nMost significant SNPs\n\n\nadjust_with_position %>%\n  arrange(GC) %>%\n  head(10)\n\n   CHR       SNP     UNADJ        GC   BONF   HOLM SIDAK_SS SIDAK_SD\n1    8  rs279466 5.549e-07 1.023e-06 0.7095 0.7095   0.5081   0.5081\n2    8  rs279460 5.549e-07 1.023e-06 0.7095 0.7095   0.5081   0.5081\n3    8  rs279453 5.549e-07 1.023e-06 0.7095 0.7095   0.5081   0.5081\n4    8 rs2623297 5.549e-07 1.023e-06 0.7095 0.7095   0.5081   0.5081\n5    8  rs279973 1.289e-06 2.287e-06      1      1   0.8075   0.8075\n6    8  rs185773 1.289e-06 2.287e-06      1      1   0.8075   0.8075\n7    8  rs183967 1.289e-06 2.287e-06      1      1   0.8075   0.8075\n8    4 rs7673394 1.325e-06 2.348e-06      1      1   0.8161   0.8161\n9    3 rs1097157 3.881e-06 6.552e-06      1      1    0.993    0.993\n10   3 rs1840290 3.881e-06 6.552e-06      1      1    0.993    0.993\n   FDR_BH FDR_BY  position\n1  0.1774      1  94153170\n2  0.1774      1  94155568\n3  0.1774      1  94157823\n4  0.1774      1  94158475\n5  0.2117      1  94132061\n6  0.2117      1  94132798\n7  0.2117      1  94133467\n8  0.2117      1 176437221\n9  0.4962      1  82780003\n10 0.4962      1  82785436\n\nCreate manhattan plot\n\n\nadjust_with_position %>%\n  mutate(minuslogp = -log10(GC),\n         CHR = as.factor(CHR)) %>%\n  ggplot(aes(x = CHR, y = minuslogp, group = interaction(CHR, position), color = CHR)) + \n  geom_point(position = position_dodge(0.8)) + \n  labs(x = 'chromosome', y = expression(paste('-log'[10],'(p-value)')))+\n  theme_classic()+\n  scale_color_manual(values=natparks.pals(\"DeathValley\",24))+\n  theme(legend.position = \"none\")\n\n\n\n\n\nhapmap$fam %>%\n  count(affected)\n\n  affected  n\n1        1 56\n2        2 56\n3       NA 53\n\nAccount for correlation\n\n\nchr1_200 <- hapmap$genotypes[1:165, 1:200]\nhapmap.ld <- ld(chr1_200, depth = 199, stats = \"R.squared\", symmetric = TRUE)\ncolor.pal <- natparks.pals(\"Acadia\", 10)\nimage(hapmap.ld, lwd = 0, cuts = 9, col.regions = color.pal, colorkey = TRUE)\n\n\n\n\n\n#get monomorphic SNPs only\nmaf_chr1_200 <- col.summary(chr1_200)$MAF\nmono <- which(maf_chr1_200 == 0)\n\n# calculate LD on polymorphic SNPs only\nhapmap.ld.nomono <- ld(chr1_200[,-mono], depth = 199-length(mono), stats = \"R.squared\", symmetric = TRUE)\n\n# plot \nimage(hapmap.ld.nomono, lwd = 0, cuts = 9, col.regions = color.pal, colorkey = TRUE)\n\n\n\n\n\n\n",
      "last_modified": "2022-11-16T09:06:29-06:00"
    },
    {
      "path": "index.html",
      "title": "An Extension of Multiple Hypothesis Testing in Statistical Genetics",
      "description": "A project by Will Brazgel and Erin Franke exploring multiple hypothesis testing and using PLINK and R to efficiently execute it on genetic data\n",
      "author": [],
      "contents": "\nMotivation here\n\n\n\n",
      "last_modified": "2022-11-16T08:43:59-06:00"
    },
    {
      "path": "multipletesting.html",
      "title": "Multiple Hypothesis Testing",
      "description": "What it is and why it is important for when working with genetic data \n",
      "author": [],
      "contents": "\nExplain background of multiple testing\n\n\n\n",
      "last_modified": "2022-11-14T20:23:21-06:00"
    },
    {
      "path": "plink.html",
      "title": "Understanding genetic data with PLINK",
      "description": "How we used PLINK to make analyzing genetic data more computationally efficient\n",
      "author": [],
      "contents": "\nExplain how we used PLINK\n\n\n\n",
      "last_modified": "2022-11-14T20:23:22-06:00"
    }
  ],
  "collections": []
}
