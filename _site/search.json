{
  "articles": [
    {
      "path": "hapmapAnalysis.html",
      "title": "A final analysis of our HapMap data",
      "description": "How we combined our knowledge of multiple hypothesis testing and PLINK results to determine an appropriate significance threshold for our HapMap dataset\n",
      "author": [],
      "contents": "\n\n\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(snpStats)\nlibrary(NatParksPalettes)\n\n\nLoad hapmap data\nCreate a null trait and write a file to the plink data folder.\n\n\nfam <- 'plinkData/HapMap_3_r3_1.fam'\nbim <- 'plinkData/HapMap_3_r3_1.bim'\nbed <- 'plinkData/HapMap_3_r3_1.bed'\n\nhapmap <- read.plink(bed, bim, fam)\n\n\n\n\nmanhattan_data <- cbind(hapmap$fam %>% select(1:2), trait = rnorm(n = 165, mean = 0, sd = 1))\nwrite_delim(manhattan_data, \"plinkData/manhattandata\")\n\n\nUse command to run GWAS in PLINK, accounting for correlated SNPs\n- ./plink –bfile HapMap_3_r3_1 –assoc –adjust –pheno manhattandata –out as2\nRead in results from PLINK and create Manhattan plot\n\n\nresults <- read_table(\"plinkData/as2.qassoc.adjusted\")\n\nresults_with_position <- results %>%\n  mutate(CHR = as.integer(CHR)) %>%\n  left_join(hapmap$map %>%\n              select(snp.name, position, chromosome), by = c(\"SNP\" = \"snp.name\", \"CHR\" = \"chromosome\"))\n\n\n\n\nresults_with_position %>%\n  mutate(minuslogp = -log10(GC),\n         CHR = as.factor(CHR)) %>%\n  ggplot(aes(x = CHR, y = minuslogp, group = interaction(CHR, position), color = CHR)) + \n  geom_point(position = position_dodge(0.8)) + \n  labs(x = 'chromosome', y = expression(paste('-log'[10],'(p-value)')))+\n  theme_classic()+\n  scale_color_manual(values=natparks.pals(\"DeathValley\",24))+\n  theme(legend.position = \"none\")\n\n\n\nComplete replications\nSimulation based approach. Approximately 14.45 minutes to run GWAS in plink, then 3 minutes 20 seconds to load files into R.\n\n\ncreate_quantitative_trait <- function(i){\n  y <- rnorm(n = 165, mean = 0, sd = 1) \n}\n\ntraits <- as.data.frame(replicate(1000, create_quantitative_trait()))\n\ntraits_identified <- cbind(hapmap$fam %>%\n        select(1:2), traits)\n\nwrite_delim(traits_identified, \"plinkData/traits_identified\")\n\n\n./plink –bfile HapMap_3_r3_1 –assoc –pheno traits_identified –all-pheno –pfilter 1e-3\n\n\ndataFiles <- lapply(Sys.glob(\"plinkData/plink.P*.qassoc\"), read_table)\n\npvalues <- sapply(dataFiles, function(x) min(x$P, na.rm=TRUE))\n\nas.data.frame(pvalues) %>%\n  ggplot(aes(x=pvalues))+\n  geom_density(fill = \"cadetblue\")+\n  theme_classic()+\n  annotate(geom = \"text\", color = \"red\", x = 1e-05, y = 250000, label = \"0.05 quantile:\\n7.31495e-08\", family = \"mono\", cex = 3)+\n  geom_vline(xintercept = 7.31495e-08, color = \"red\", linetype = \"dashed\")+\n  labs(x=\"P-values\", y = \"Density\", title = \"Distribution of minimum p-values for 1000 replications\")+\n  geom_curve(aes(x = 1e-05, y = 270000, xend = 1e-06, yend = 350000), \n             arrow = arrow(length = unit(0.03, \"npc\")), curvature = 0.3, color = \"red\")+\n  theme(plot.title.position = \"plot\", \n        plot.title = element_text(family = \"mono\"), \n        axis.title = element_text(family = \"mono\"), \n        axis.text = element_text(family = \"mono\"))\n\n\nquantile(pvalues, 0.05)\n\n         5% \n7.31495e-08 \n\n\n\n\n",
      "last_modified": "2022-11-17T15:27:15-06:00"
    },
    {
      "path": "index.html",
      "title": "An Extension of Multiple Hypothesis Testing in Statistical Genetics",
      "description": "A project by Will Brazgel and Erin Franke exploring multiple hypothesis testing and using PLINK and R to efficiently execute it on genetic data\n",
      "author": [],
      "contents": "\nMotivation here\n\n\n\n",
      "last_modified": "2022-11-16T08:43:59-06:00"
    },
    {
      "path": "multipletesting.html",
      "title": "Multiple Hypothesis Testing",
      "description": "What it is and why it is important for when working with genetic data \n",
      "author": [],
      "contents": "\nExplain background of multiple testing\nPower of GWAS\n\n\n\n",
      "last_modified": "2022-11-16T13:44:18-06:00"
    },
    {
      "path": "plink.html",
      "title": "Understanding genetic data with PLINK",
      "description": "How we used PLINK to make analyzing genetic data more computationally efficient\n",
      "author": [],
      "contents": "\nExplain how we used PLINK\n\n\n\n",
      "last_modified": "2022-11-14T20:23:22-06:00"
    }
  ],
  "collections": []
}
